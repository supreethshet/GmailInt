<?xml version="1.0" encoding="UTF-8"?>
<Module>
  <ModulePrefs title="Pivotal CRM"
    description=""
    height="220"
    author="Pivotal"
    author_email="pawan.ch@mypivotalcrm.in"
    author_location="In Gadget, Earth">

    <!-- This one is not specific to Gmail contextual gadgets. -->
    <Require feature="dynamic-height"/>

    <Require feature="google.contentmatch">
      <Param name="extractors">google.com:SubjectExtractor</Param>
    </Require>

  </ModulePrefs>

  <Content type="html" view="card">
    <![CDATA[
    <!-- Start with Single Sign-On -->
    <div id="content_div"></div>
    <script type="text/javascript">
      debugger;
      function getHtml() {
      var params = {};
      params[gadgets.io.RequestParameters.CONTENT_TYPE] = gadgets.io.ContentType.TEXT;
      var url = "http://www.google.com";
      gadgets.io.makeRequest(url, response, params);
      };
      function response(obj) {
      debugger;
      //obj.text contains the text of the page that was requested
      var str = obj.text;
      var html =  str.substr(0,400);
      document.getElementById('content_div').innerHTML = html;
      document.body.appendChild(html);
      };
      gadgets.util.registerOnLoadHandler(getHtml);
      <!-- Fetch the array of content matches. -->
      matches = google.contentmatch.getContentMatches();
      var matchList = document.createElement('UL');
      var listItem;
      var extractedText;

      <!-- Iterate through the array and display output for each match. -->
      for (var match in matches) {
      for (var key in matches[match]) {
      listItem = document.createElement('LI');
      extractedText = document.createTextNode(key + ": " + matches[match][key]);
      listItem.appendChild(extractedText);
      matchList.appendChild(listItem);
      }
      }
      document.body.appendChild(matchList);
      gadgets.window.adjustHeight(100);
    </script>
    ]]>
  </Content>
</Module>
